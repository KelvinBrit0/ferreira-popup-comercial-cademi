<!-- ===== POPUP WHATSAPP ===== -->
<div class="wpp-popup-overlay" id="wppPopup">
  <div class="wpp-popup">
    <button class="wpp-popup-close" id="wppClose" aria-label="Fechar">&times;</button>

    <span class="wpp-popup-badge">Novidade 2026</span>

    <div class="wpp-popup-icon">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
      </svg>
    </div>

    <h2>Sua experiência mudou!</h2>
    <p>A partir de agora você conta com um <strong>analista exclusivo</strong> para te orientar no que precisar.</p>

    <a
      class="wpp-popup-cta"
      href="https://wa.me/5521923670493?text=Oi!%20Vi%20que%20agora%20tenho%20um%20analista%20exclusivo.%20Como%20funciona%20o%20direcionamento%3F"
      target="_blank"
      rel="noopener noreferrer"
      id="wppCta"
    >
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
      </svg>
      Falar com meu Analista
    </a>

    <button class="wpp-popup-dismiss" id="wppDismiss">Não, obrigado</button>
  </div>
</div>

<!-- ===== BOTÃO FLUTUANTE WHATSAPP ===== -->
<a
  class="wpp-fab"
  id="wppFab"
  href="https://wa.me/5521923670493?text=Oi!%20Vi%20que%20agora%20tenho%20um%20analista%20exclusivo.%20Como%20funciona%20o%20direcionamento%3F"
  target="_blank"
  rel="noopener noreferrer"
  aria-label="WhatsApp"
>
  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/>
  </svg>
</a>

<script>
(function () {
  var STORAGE_KEY = 'wpp_popup_closed';
  var DELAY_MS = 5000;

  var overlay = document.getElementById('wppPopup');
  var fab = document.getElementById('wppFab');
  var popupCard = overlay.querySelector('.wpp-popup');

  // Se já fechou antes, mostra direto o botão flutuante
  if (sessionStorage.getItem(STORAGE_KEY)) {
    fab.classList.add('visible');
    return;
  }

  // Mostra o popup após o delay
  setTimeout(function () {
    overlay.classList.add('active');
  }, DELAY_MS);

  function closePopup() {
    // Torna o FAB mensurável temporariamente (scale(0) zera o rect)
    fab.style.transition = 'none';
    fab.style.transform = 'scale(1)';

    var fabRect = fab.getBoundingClientRect();
    var popupRect = popupCard.getBoundingClientRect();

    // Restaura o FAB ao estado oculto
    fab.style.transform = '';
    fab.style.transition = '';

    var fabCenterX = fabRect.left + fabRect.width / 2;
    var fabCenterY = fabRect.top + fabRect.height / 2;
    var popupCenterX = popupRect.left + popupRect.width / 2;
    var popupCenterY = popupRect.top + popupRect.height / 2;

    var dx = fabCenterX - popupCenterX;
    var dy = fabCenterY - popupCenterY;

    // Anima o popup em direção ao FAB
    popupCard.style.transition = 'transform 0.65s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.25s ease 0.45s, border-radius 0.4s ease';
    popupCard.style.transform = 'translate(' + dx + 'px, ' + dy + 'px) scale(0.05)';
    popupCard.style.opacity = '0';
    popupCard.style.borderRadius = '50%';

    // Faz o fundo sumir mas mantém overlay visível durante a animação
    overlay.classList.add('closing');

    sessionStorage.setItem(STORAGE_KEY, '1');

    // Após a animação, esconde tudo e mostra o fab
    setTimeout(function () {
      overlay.classList.remove('active');
      overlay.style.display = 'none';
      fab.classList.add('visible');
    }, 700);
  }

  document.getElementById('wppClose').addEventListener('click', closePopup);
  document.getElementById('wppDismiss').addEventListener('click', closePopup);

  // Fecha ao clicar fora do card
  overlay.addEventListener('click', function (e) {
    if (e.target === overlay) closePopup();
  });

  // Fecha com ESC
  document.addEventListener('keydown', function (e) {
    if (e.key === 'Escape') closePopup();
  });

  // Salva no sessionStorage ao clicar no CTA
  document.getElementById('wppCta').addEventListener('click', function () {
    sessionStorage.setItem(STORAGE_KEY, '1');
  });
})();
</script>
